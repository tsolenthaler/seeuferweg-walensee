<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daten-Test - Seeuferweg Walensee</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container py-5">
        <h1 class="mb-4">Datenquellen-Test</h1>
        
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Heidiland</h5>
                        <p class="card-text">
                            <strong>Items:</strong> <span id="heidiland-count">Laden...</span><br>
                            <strong>Im Walensee-Bereich:</strong> <span id="heidiland-filtered">-</span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Glarnerland</h5>
                        <p class="card-text">
                            <strong>Items:</strong> <span id="glarnerland-count">Laden...</span><br>
                            <strong>Im Walensee-Bereich:</strong> <span id="glarnerland-filtered">-</span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Rapperswil</h5>
                        <p class="card-text">
                            <strong>Items:</strong> <span id="rapperswil-count">Laden...</span><br>
                            <strong>Typ:</strong> <span id="rapperswil-type">-</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <h3>Gesamt</h3>
            <div class="alert alert-info">
                <strong>Total POIs:</strong> <span id="total-pois">-</span><br>
                <strong>Highlights:</strong> <span id="total-highlights">-</span><br>
                <strong>Aktivit√§ten:</strong> <span id="total-activities">-</span><br>
                <strong>Fotopoints:</strong> <span id="total-fotopoints">-</span>
            </div>
        </div>
        
        <div class="mt-4">
            <h3>POI Typen</h3>
            <div id="types-list" class="row"></div>
        </div>
        
        <div class="mt-4">
            <h3>Beispiel POIs</h3>
            <div id="sample-pois"></div>
        </div>
    </div>
    
    <script src="js/data-processor.js"></script>
    <script>
        let processor;
        
        async function testData() {
            processor = new DataProcessor();
            
            // Load raw data
            const [heidiland, glarnerland, rapperswil] = await Promise.all([
                fetch('heidiland.json').then(r => r.json()),
                fetch('glarnerland.json').then(r => r.json()),
                fetch('rapperswil.json').then(r => r.json())
            ]);
            
            // Display raw counts
            document.getElementById('heidiland-count').textContent = heidiland.length;
            document.getElementById('glarnerland-count').textContent = glarnerland.length;
            document.getElementById('rapperswil-count').textContent = rapperswil.length;
            document.getElementById('rapperswil-type').textContent = 'Kategorien (keine POIs)';
            
            // Load and process data
            await processor.loadAllData();
            
            // Display filtered counts
            const heidilandFiltered = processor.normalizedData.filter(p => p.source === 'heidiland').length;
            const glarnerFilter = processor.normalizedData.filter(p => p.source === 'glarnerland').length;
            
            document.getElementById('heidiland-filtered').textContent = heidilandFiltered;
            document.getElementById('glarnerland-filtered').textContent = glarnerFilter;
            
            // Display stats
            const stats = processor.getStats();
            document.getElementById('total-pois').textContent = stats.totalPOIs;
            document.getElementById('total-highlights').textContent = stats.totalHighlights;
            document.getElementById('total-activities').textContent = stats.totalActivities;
            document.getElementById('total-fotopoints').textContent = stats.totalFotopoints;
            
            // Display types
            const typesList = document.getElementById('types-list');
            Object.entries(stats.byType).forEach(([type, count]) => {
                typesList.innerHTML += `
                    <div class="col-md-3 mb-2">
                        <span class="badge bg-primary">${type}: ${count}</span>
                    </div>
                `;
            });
            
            // Display sample POIs
            const samplePois = document.getElementById('sample-pois');
            processor.getAllPOIs().slice(0, 10).forEach(poi => {
                samplePois.innerHTML += `
                    <div class="card mb-2">
                        <div class="card-body">
                            <h6>${poi.name}</h6>
                            <small class="text-muted">
                                Quelle: ${poi.source} | Typ: ${poi.type} | 
                                Bilder: ${poi.images.length} | 
                                Lat: ${poi.location.lat.toFixed(4)}, Lon: ${poi.location.lon.toFixed(4)}
                            </small>
                        </div>
                    </div>
                `;
            });
        }
        
        testData();
    </script>
</body>
</html>
